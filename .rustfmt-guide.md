# Rustfmt 代码风格配置说明

## 概述

本项目已配置 rustfmt 代码格式化工具，用于自动约束和统一代码风格。

## 配置文件

- **rustfmt.toml**: 项目根目录下的 rustfmt 配置文件
- 包含稳定版 Rust 可用的所有格式化选项
- 主要配置：
  - 最大行宽：100 字符
  - 缩进：4 个空格
  - 换行风格：Unix
  - 自动导入排序和模块重排序

## 使用方法

### 本地开发

1. **格式化所有代码**：
   ```bash
   cargo fmt --all
   ```

2. **检查代码格式**（不修改文件）：
   ```bash
   cargo fmt --all -- --check
   ```

3. **在 IDE 中配置**：
   - VS Code: 安装 `rust-analyzer` 插件后会自动使用项目的 rustfmt.toml
   - 可以启用 "Format on Save" 自动格式化

### CI/CD 流程

- CI 流程会**检查**代码格式，但**不会自动提交**格式化修改
- 如果格式检查失败，开发者需要在本地运行 `cargo fmt --all` 并提交修改
- 这确保了代码提交的完整性和可追溯性

## 修改内容

1. ✅ 添加了 `rustfmt.toml` 配置文件
2. ✅ 修改了 `.github/workflows/ci.yml`：
   - 将 "Auto-format code" 步骤改为 "Check code formatting"
   - 移除了自动提交和推送格式化修改的逻辑
   - 简化了 build job 的权限配置

## 优势

- ✨ 本地开发时自动约束代码风格
- 📝 统一团队代码风格标准
- 🚀 减少 PR 中关于代码格式的讨论
- 🔒 保持代码提交的完整性（不会自动修改提交）
